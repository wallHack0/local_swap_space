{% extends 'base.html' %}

{% block title %}Chat Detail{% endblock %}

{% block content %}
<div class="container my-4">
    <h1>Chat with {% if request.user == chat.participant_one %}{{ chat.participant_two.username }}{% else %}{{ chat.participant_one.username }}{% endif %}</h1>
    <!-- Header displaying with whom the user is chatting, dynamically showing the other participant -->

    <div class="messages mb-4">
        {% for message in messages %}
            <div class="border rounded p-2 mb-2">
                <p><strong>{{ message.sender.username }}:</strong> {{ message.text }}</p>
                <p class="text-muted"><small>{{ message.sent_at }}</small></p>
            </div>
            <!-- Loop through each message in the chat and display the sender's username, message text, and the timestamp -->
        {% empty %}
            <p>No messages yet.</p>
        {% endfor %}
    </div>

    <form action="{% url 'send_message' chat_id=chat.pk %}" method="post">
        {% csrf_token %}
        <div class="form-group">
            <textarea name="message_text" class="form-control" placeholder="Type your message here..." rows="3"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Send</button>
    </form>
</div>
{% endblock %}
